<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"  xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorate="~{common/layout}">
<head>
    <meta charset="UTF-8">
    <title>任务列表</title>
    <!--    <link rel="stylesheet" th:href="@{/static/css/bootstrap.min.css}" type="text/css"/>-->
    <link rel="stylesheet" th:href="@{/static/js/plugins/bootstrap-table/bootstrap-table.css}" type="text/css"/>
    <link th:href="@{/static/js/plugins/bootstrap-table/extensions/page-jumpto/bootstrap-table-jumpto.css}" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/static/js/plugins/fileinput/css/fileinput.css}">
    <script>
        function downloadTaskFile(taskNo) {
            window.location.href=ctxPath+'trans/downloadTaskFile/'+taskNo;
        }
        function giveupTask(taskNo) {
            $.post(ctxPath+'task/giveupTask',{taskId:taskNo}).done(function (data) {
                if(data.success){
                    layer.alert('放弃任务成功',{icon:1},function () {
                        window.location.href=ctxPath+data.msg;
                    })
                }else{
                    layer.alert('放弃任务失败',{icon:2},function () {
                        window.location.href=ctxPath+data.msg;
                    })
                }
            });
        }
    </script>
</head>
<body>
<th:block layout:fragment = "content">
    <div class="row">
        <table class="table table-hover">
            <thead>
            <tr class="bg-info text-white">
                <th>任务号</th>
                <th>领取时间</th>
                <th>订单到期时间</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="row"  th:text="${task.taskNo}"></th>
                <td th:text="${task.beginTime}"></td>
                <td th:text="${task.expirationDate}"></td>
                <td>
                    <div class="btn-group btn-group-sm">
                    <button type="button" class="btn btn-outline-primary" th:onclick="downloadTaskFile('[[${task.tbOrder.orderId}]]')"><i class="fa fa-download"></i>下载</button>
                    <button type="button" class="btn btn-outline-info"><i class="fa fa-upload"></i>上传</button>
                    <button type="button" class="btn btn-outline-danger" th:onclick="giveupTask('[[${task.taskId}]]')"><i class="fa fa-trash"></i>放弃</button>
                </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</th:block>
<th:block layout:fragment = "bodyAssets">
    <script th:src="@{/static/js/plugins/bootstrap-table/bootstrap-table.js}"></script>
    <script th:src="@{/static/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.js}"></script>
    <script th:src="@{/static/js/plugins/bootstrap-table/extensions/page-jumpto/bootstrap-table-jumpto.min.js}"></script>
    <script th:src="@{/static/js/plugins/fileinput/js/fileinput.min.js}"></script>
</th:block>
</body>
</html>